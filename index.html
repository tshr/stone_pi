<!DOCTYPE html>
<html>
<head>
  <title>Approximating Pi with the Stone in Pond Approach</title>
  <link href='http://fonts.googleapis.com/css?family=Cinzel' rel='stylesheet' type='text/css'>

  <style>
    :root {
      font-family: 'Cinzel', serif;
    }

    #display {
      float: left;
      font-size: 40px;
      line-height: 40px;
      width: 500px;
    }

    #result {
      color: #dddddd;
    }

    #result #completed {
      color: #000000;
    }

    #inscribed_circle {
      border: 1px solid;
      float: left;
      margin-right: 10px;
    }
  </style>

  <script>
    var number_of_tries = 0,
        number_inside_circle = 0,
        pi_string = Math.PI.toString();

    var draw_circle = function() {

      window.canvas = document.getElementById('inscribed_circle');
      window.context = canvas.getContext('2d');

      var centerX, radius, centerY;
      centerX = radius = canvas.width / 2;
      centerY = canvas.height / 2;

      context.beginPath();
      context.arc(centerX, centerY, radius, 0, 2 * Math.PI);
      context.stroke();
    };

    var inside_circle = function(coord) {

      var width = Math.abs(coord.x - 0.5),
          height = Math.abs(coord.y - 0.5),
          radius = Math.sqrt(width * width + height * height);

      return (radius <= 0.5);
    };

    var get_approximation = function() {

      var value = (number_inside_circle / number_of_tries) * 4,
          approx_string = value.toString(),
          result = '<span id="completed">';

      for ( var i = 0; i < approx_string.length; i++ ) {
        if (approx_string[i] === pi_string[i]) {
          result += approx_string[i];
        } else {
          break;
        }
      }

      result += '</span>';
      result += approx_string.slice(i);
      return result;
    };

    var display_approximation = function() {

      document.getElementById('result');
      document.getElementById('result').innerHTML = get_approximation();
    };

    var draw_dot = function(coord, inside) {

      context.fillStyle = inside ?  '1b57e0' : '808080';
      context.fillRect(Math.floor(coord.x * canvas.width), Math.floor(coord.y * canvas.height), 1, 1);
    };

    window.onload = function() {

      draw_circle();

      (function run() {

        var sample = { 'x' : Math.random(), 'y' : Math.random() };
        var inside = inside_circle(sample);
        if (inside) number_inside_circle++;
        number_of_tries++;
        display_approximation();
        draw_dot(sample, inside);
        setTimeout(run, 20);
      }());
    };
  </script>
</head>
<body>
  <canvas id='inscribed_circle' width='400' height='400'></canvas>
  <div id='display' >&Pi; &asymp; <span id='result'></span></div>
</body>
</html>